# Define both registry paths
$regPath1 = "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config"
$regPath2 = "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config"

# Function to check key existence and value
function Test-EnableCertPaddingCheck {
    param (
        [string]$Path
    )

    if (Test-Path $Path) {
        $value = Get-ItemProperty -Path $Path -Name "EnableCertPaddingCheck" -ErrorAction SilentlyContinue
        if ($null -ne $value -and $value.EnableCertPaddingCheck -eq 1) {
            return $true
        }
    }
    return $false
}

# Check both keys
$key1OK = Test-EnableCertPaddingCheck -Path $regPath1
$key2OK = Test-EnableCertPaddingCheck -Path $regPath2

if ($key1OK -and $key2OK) {
    Write-Host "Registry keys and values are present."
    exit 0
} else {
    Write-Host "Registry keys or values not found."
    exit 1
}
